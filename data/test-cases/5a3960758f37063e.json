{"uid":"5a3960758f37063e","name":"Validate the bioburden residue verification final summary page","fullName":"tests.scenarios.test_multi_prodcution_protocol.TestMultiProductionProtocol#test_validate_final_summary_bioburden_residue_verification_details","historyId":"c9d88d40958b76a61e6483e623019667","time":{"start":1709039602589,"stop":1709039609881,"duration":7292},"description":"This test case tests API to Create Protocol for bioburden residue verification and validate the final summary details","descriptionHtml":"<p>This test case tests API to Create Protocol for bioburden residue verification and validate the final summary details</p>\n","status":"broken","statusMessage":"KeyError: 'sampleLimitsDetails'","statusTrace":"self = <test_multi_prodcution_protocol.TestMultiProductionProtocol object at 0x000002CCA363B050>\n\n    @allure.title(\"Validate the bioburden residue verification final summary page\")\n    @allure.description(\"This test case tests API to Create Protocol for bioburden residue verification and \"\n                        \"validate the final summary details\")\n    @allure.link(\"https://app.clickup.com/t/86cumczx2\")\n    @pytest.mark.formulation\n    @pytest.mark.validate_final_summary_bioburden_residue_verification_details\n    def test_validate_final_summary_bioburden_residue_verification_details(self):\n        data = self.test_create_protocol_bioburden_residue_verification_based_on_policy_direct_indirect()\n        no_of_runs_payload = number_of_runs_sample_limits()\n    \n        data.update({\"no_of_runs_payload\": no_of_runs_payload})\n    \n        self.protocol_common_method.update_protocol_residue_verification_sample_limits_run(data)\n    \n        final_summary = self.protocol_common_method.get_active_final_summary_details(data)[\"response\"]\n    \n        equipments_id = self.protocol_common_method.get_protocol_equipments_ids(data)\n        for i in equipments_id:\n            data.update({\"equipment\": i[\"equipment_id\"], \"external_id\": i[\"external_id\"],\n                         \"columns\": [\"sample id\", \"Analytical Method\", \"sampling area (sqcm)\", \"Rinse volume(ml)\",\n                                     \"rinse_limit_ppm\", \"swab_limit_ppm\"], \"sample_type\": \"Bioburden\"})\n            sample_limits = json.loads(final_summary)[\"result\"]\n            data.update({\"sample_profile\": sample_limits})\n>           self.protocol_bioburden.compare_samples_swab_rinse_sample_limits_bioburden(data)\n\ntests\\scenarios\\test_multi_prodcution_protocol.py:5380: \n_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _\n\nself = <unit.protocols.protocol_bioburden_residue_verification.ProtocolBioburdenAcceptanceCriteria object at 0x000002CCA186B9D0>\ndata = {'add_new_protocol_payload': {'authorId': 6, 'description': 'Automation Protocol', 'externalId': 'Protocol-FWU8', 'nam...ling area (sqcm)', 'Rinse volume(ml)', 'rinse_limit_ppm', 'swab_limit_ppm'], 'description': 'Automation Protocol', ...}\n\n    def compare_samples_swab_rinse_sample_limits_bioburden(self, data):\n        policies = [data[\"direct_policy\"], data[\"indirect_policy\"]]  # Include the direct policy and indirect policy\n        for policy in policies:\n            if policy == \"custom\":\n                sheet_name = data[\"external_id\"] + \"_samples_custom\"\n                sample_limits = Excel.read_excel_columns_name_row_value(const.get_master_data(), sheet_name,\n                                                                        data[\"columns\"], data[\"sample_type\"])\n    \n                swab_list = [item for item in sample_limits[\"swab_limit_ppm\"] if item != '#VALUE!']\n                result_list = [item for item in sample_limits[\"rinse_limit_ppm\"] if item != '#VALUE!']\n                rinse_index = 0\n                swab_index = 0\n                for sample_limit in data[\"sample_profile\"]['sampleLimitsDetails']:\n                    if str(sample_limit.get('sampleType')).strip() == str(\"BioBurden\").strip():\n                        sample_id = sample_limit.get('sampleId')\n                        if sample_id is not None and sample_id in sample_limits.get(\"sample id\"):\n                            if sample_id.endswith((\"/BI-5\", \"/BI-6\", \"/BI-7\", \"/BI-8\")):\n                                method_type = sample_limit.get('methodType')\n                                limit_value = sample_limit['limit']['value']\n                                if limit_value is not None:\n                                    if method_type == 'swab':\n                                        assert round(limit_value, 3) == round(swab_list[swab_index], 3), \\\n                                            f\"Sampling area from API not matching: {limit_value}, with surface area: {swab_list[swab_index]}\"\n                                        swab_index += 1\n                                    if method_type == 'rinse':\n                                        assert round(limit_value, 3) == round(result_list[rinse_index], 3), \\\n                                            f\"Rinse volume from API not matching: {limit_value}, with surface area: {result_list[rinse_index]}\"\n                                        rinse_index += 1\n    \n                            if sample_id.endswith((\"/BI-1\", \"/BI-2\", \"/BI-3\", \"/BI-4\")):\n                                method_type = sample_limit.get('methodType')\n                                limit_value = sample_limit['limit']['value']\n                                if limit_value is not None:\n                                    if method_type == 'swab':\n                                        assert round(limit_value, 3) == round(swab_list[swab_index], 3), \\\n                                            f\"Sampling area from API not matching: {limit_value}, with surface area: {swab_list[swab_index]}\"\n                                        swab_index += 1\n                                    if method_type == 'rinse':\n                                        assert round(limit_value, 3) == round(result_list[rinse_index], 3), \\\n                                            f\"Rinse volume from API not matching: {limit_value}, with surface area: {result_list[rinse_index]}\"\n                                        rinse_index += 1\n            else:\n                sheet_name = data[\"external_id\"] + \"_samples\"\n    \n                sample_limits = Excel.read_excel_columns_name_row_value(const.get_master_data(), sheet_name,\n                                                                        data[\"columns\"], data[\"sample_type\"])\n    \n                rinse_vol = [item for item in sample_limits[\"Rinse volume(ml)\"] if item != '#VALUE!']\n                swab_area = [item for item in sample_limits[\"sampling area (sqcm)\"] if item != '#VALUE!']\n                swab_index = 0\n                rinse_index = 0\n>               for sample_limit in data[\"sample_profile\"]['sampleLimitsDetails']:\nE               KeyError: 'sampleLimitsDetails'\n\ntests\\unit\\protocols\\protocol_bioburden_residue_verification.py:408: KeyError","flaky":false,"newFailed":false,"newBroken":false,"newPassed":false,"retriesCount":2,"retriesStatusChange":true,"beforeStages":[{"name":"login","time":{"start":1709038682534,"stop":1709038683052,"duration":518},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0},{"name":"get_facility","time":{"start":1709038683052,"stop":1709038683859,"duration":807},"status":"passed","steps":[],"attachments":[],"parameters":[],"attachmentsCount":0,"shouldDisplayMessage":false,"hasContent":false,"attachmentStep":false,"stepsCount":0}],"afterStages":[],"labels":[{"name":"tag","value":"validate_final_summary_bioburden_residue_verification_details"},{"name":"tag","value":"formulation"},{"name":"tag","value":"multi_production_protocol"},{"name":"tag","value":"scenario"},{"name":"parentSuite","value":"tests.scenarios"},{"name":"suite","value":"test_multi_prodcution_protocol"},{"name":"subSuite","value":"TestMultiProductionProtocol"},{"name":"host","value":"DESKTOP-ESU2KLG"},{"name":"thread","value":"28604-MainThread"},{"name":"framework","value":"pytest"},{"name":"language","value":"cpython3"},{"name":"package","value":"tests.scenarios.test_multi_prodcution_protocol"},{"name":"resultFormat","value":"allure2"}],"parameters":[],"links":[{"name":"https://app.clickup.com/t/86cumczx2","url":"https://app.clickup.com/t/86cumczx2","type":"link"}],"hidden":false,"retry":false,"extra":{"severity":"normal","retries":[{"uid":"d196dc9686a8e052","status":"broken","statusDetails":"AttributeError: 'ProtocolBioburdenAcceptanceCriteria' object has no attribute 'compare_samples_swab_rinse_sample_limits_bioburden_summary'","time":{"start":1708873731364,"stop":1708873737793,"duration":6429}},{"uid":"6187c04b7abf0f6f","status":"failed","statusDetails":"AssertionError: 419","time":{"start":1708872962087,"stop":1708872962087,"duration":0}}],"categories":[{"name":"Test defects","matchedStatuses":[],"flaky":false}],"tags":["validate_final_summary_bioburden_residue_verification_details","multi_production_protocol","scenario","formulation"]},"source":"5a3960758f37063e.json","parameterValues":[]}